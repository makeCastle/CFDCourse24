@page install Установка и сборка проекта

@tableofcontents

Описанная ниже процедура собирает проект в отладочной конфигурации.
Для проведения необходимых модификаций для сборки релизной версии смотри @ref release_build.

# Подготовка {#prep}
1. Для сборки проекта необходимо установить git и cmake>=3.0
   - В Windows необходимо скачать и установить диструбутивы:
     - https://github.com/git-for-windows/git/releases/download/v2.38.1.windows.1/Git-2.38.1-64-bit.exe
     - https://github.com/Kitware/CMake/releases/download/v3.24.2/cmake-3.24.2-windows-x86_64.msi

     При установке cmake проследите, что бы путь к cmake.exe сохранился в системных путях. Msi установщик спросит об этом в диалоге.
   - В линуксе используйте менеджеры пакетов, предоставляемые вашим дистрибутивом.
     Также проследите чтобы были доступны компиллятор g++ и отладчик gdb.

2. Создайте папку в системе для репозиториев. Например D:/git_repos/

3. Возьмите необходимые заголовочные библиотеки boost из https://disk.yandex.ru/d/GwTZUvfAqPsZBQ
   и распакуйте архив в папку для репозиториев (D:/git_repos/boost).
   Проследите, чтобы внутри папки boost сразу шли папки с кодом (accumulators, algorithm, ...) и заголовочные файлы (align.hpp, aligned_storage.hpp, ...)
   без дополнительных уровней вложения.

4. Откройте терминал (git bash в Windows).

5. С помощью команды cd в терминале перейдите в папку для репозиториев
   \code
   > cd D:/git_repos
   \endcode

6. Клонируйте репозиторий
   \code
   > git clone https://github.com/kalininei/CFDCourse24
   \endcode
   В директории (D:/git_repos в примере) появится папка CFDCourse24, которая является корневой папкой проекта


# VisualStudio {#vs_build}

1. Cоздайте папку build в корне проекта СFDCourse24

2. Скопируйте скрипт winbuild64.bat в папку build. Далее вносить изменения
   только в скопированном файле.

3. Скрипт написан для версии Visual Studio 2019. Если используется другая версия,
   измените в скрипте значение переменной CMGenerator на соответствующие вашей версии.
   Значения для разных версий Visual Studio написаны ниже
```
SET CMGenerator="Visual Studio 17 2022"
SET CMGenerator="Visual Studio 16 2019"
SET CMGenerator="Visual Studio 15 2017"
SET CMGenerator="Visual Studio 14 2015"
```

4. Запустите скрипт winbuild64.bat из папки build. Нужен доступ к интернету.
   В процессе будет скачано около 200Мб пакетов, поэтому первый запуск может занять время

5. После сборки в папке build появится проект VisualStudio cfdcourse24.sln.
   Его нужно открыть в VisualStudio.
   Дерево решения должно иметь следующий вид.
   ![](vs_solution_explorer.png)
   Проекты:
   - cfd24 - расчётная библиотека
   - cfd24_test - модульные тесты для расчётных функций

6. Проект cfd24_test необходимо назначить запускаемым проектом. Для этого нажать правой кнопкой мыши по проекту и в выпадающем меню
   выбрать соответствующий пункт. После этого заголовок проекта должен стать жирным.
   \image html win_startup_project.png width=500

7. Скомпиллировать решение. Несколько способов:
    - `Ctrl+Shift+B`,
    - `Build->Build Solution` в основном меню,
    - `Build Solution` в меню решения в дереве решения,
    - `Build` в меню проекта cfd24_test.

8. Запустить тесты (проект cfd24_test) нажав F5 (или кнопку отладки в меню).
   После отработки должно высветиться сообщение об успешном прохождении всех тестов.

9. Бинарные файлы будут скомпиллированы в папку \c CFDCourse24/build/bin/Debug.\n
   В случае работы через отладчик выходная директория, куда будут скидываться все файлы (в частности, vtk),
   должна быть \c CFDCourse24/build/src/test/.

# VSCode {#vscode_build}

1. Открыть корневую папку проека через File->Open Folder
2. Установить предлагаемые расширения cmake, c++
3. Для настройки отладки создайте конфигурацию launch.json слудующего вида
   ![](vscode_launch_json.png)
   - Для этого перейдите в меню 'Run and Dubug' (Ctrl+Shift+D), нажмите
     create launch.json, выберите пункт Node.js.
   - После этого в корневой папке появится файл .vscode/launch.json.
   - Откройте этот файл в vscode, нажмите Add configuration, (gdb) Launch или (Windows) Launch в зависимости от ОС.
   - Далее напишите имя программы как показано на картинке.
   - Используйте поле args для установки аргументов запуска.
   - Выберите созданную конфигурацию для запуска отладчика по F5
   ![](vscode_launch.png)
   
   На скриншотах представлены настройки в случае работы в линуксе. Для работы под виндоус 
   @code
   "name" : "(Windows) Launch",
   "program": "${workspaceFolder}/build/bin/Debug/cfd24_test.exe"
   @endcode
