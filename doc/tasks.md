@page tasks Задания для самостоятельной работы

# Лекция 1 (02.09)
Собрать проет cfd на своей системе и разобраться с его основными принципами

# Лекция 2 (09.09)
1. Построить график, подтверждающий второй порядок точности
   @ref poisson1d_fdm "расчётной схемы" 
2. Написать тест, аналогичный \ref test_poisson1 "[poisson1]" но
   для двумерной задачи на двумерной регулярной сетке
   \f{equation*}{
       -\left(\dfrq{u}{x} + \dfrq{u}{y}\right) = f(x, y).
   \f}
   Использовать разностную схему
   \f{equation*}{
       \frac{-u_{k[i-1,j]} + 2 u_{k[i, j]} - u_{k[i+1,j]}}{h_x^2} +
       \frac{-u_{k[i,j-1]} + 2 u_{k[i, j]} - u_{k[i,j+1]}}{h_y^2} =
       f_{k[i,j]},
   \f}
   где
   \f{equation}{
        \label{eq:tasks_ij2k}
        k[i, j] = i + (n_x+1) j
   \f}
   -- функция, переводящая парный \f$(i,j)\f$ индекс узла регурярной сетки (\f(i\f) для оси x, \f(j\f) для оси y) в сквозной индекс \f$k\f$
   сеточного вектора, \f$n_x\f$ -- количество ячеек сетки в направлении x.

   При вычислении весов \f(w_k\f) для вычисления среднеквадратичного отклонения учесть
   наличие граничных и угловых точек:
    \f{equation*}{
        w_k = \begin{cases}
                h_x h_y / 4,  &\quad  \text{для угловых точек};\\
                h_x h_y / 2,  &\quad  \text{для граничных неугловых точек};\\
                h_x h_y,      &\quad  \text{для внутренних точек}.
        \end{cases}
    \f}
    Четрые угловые точки определяются как
    \f{equation}{
        \label{eq:tasks_k2ij}
        i[k], j[k] = (0, 0), \, (0, n_y), \, (n_x, n_y), \, (n_x, 0)
    \f}
    Граничные неугловые точки:
    \f{equation*}{
        i[k], j[k] =
            \left(\overline{\left(1,n_x-1\right)}, 0\right), \,
            \left(n_x, \overline{\left(1,n_y-1\right)}\right), \,
            \left(\overline{\left(1, n_x-1\right)}, n_y\right), \,
            \left(0, \overline{\left(1,n_y-1\right)}\right)
    \f}
    Функции, переводящие сквозной индекс в пару \f(i,j\f) имеют вид
    \f{align*}{
        &i[k] = {\rm mod}\left(k, \left(n_x+1\right)\right), \quad \text{// остаток от деления}.\\
        &j[k] = \lfloor k / \left(n_x+1\right)\rfloor, \quad \text{// целая часть от деления};\\
    \f}

    Использовать класс cfd::RegularGrid2D для задания сетки.
    Функции перевода индексов узлов из сквозных в парные и обратно реализованы в классе двумерной регулярной сетки:
    - cfd::RegularGrid2D::to_split_point_index
    - cfd::RegularGrid2D::to_linear_point_index

    В случае, если решатель системы линейных уравнений не решает построенную матрицу, использовать функцию
    cfd::dbg::print для отлаточной печати матрицы в консоль (размерность задачи должна быть небольшой).

# Лекция 3 (16.09)

## Постановка задачи
Написать двумерный решатель для уравнения переноса
\f{equation*}{
    \dfr{u}{t} + U \dfr{u}{x} + V \dfr{u}{y} = 0.
\f}

Решение проводить в квадрате \f(x,y\in[-1,1]\f).

Требуется
- расчитать и нарисовать в Paraview нестационарное решение (см. \ref paraview-2d);
- построить график, иллюстрирующий увеличение нормы ошибки
  с продвижением по времени;
- исследовать устойчивость схемы. Эмпирическим путём выяснить,
  какое максимально возможный шаг по времени можно брать
  при фиксированном разбиении по пространству;
- построить график, иллюстрирующий сходимость нормы
  ошибки при уменьшении шага по времени при фиксированном разбиении
  по пространству.


### Тестовый пример 1
На этапе первичного тестирования использовать
значения скорости
\f{equation*}{
    U = 1, \quad V = 0.
\f}

А в качестве начального решения брать простой "столбик"
\f{equation*}{
    u(x,y,0) = u_0(x, y) = \begin{cases}
        1, & \; -1\leq x \leq -0.8, \; -0.1 \leq y \leq 0.1, \\
        0, & \; \text{иначе}.
    \end{cases}
\f}

\image html transport1_work_01.png width=1000

Точным решением будет функция
\f{equation*}{
    u^e(x, y, t) = u_0(x-Ut, y)
\f}

То есть этот столбик будет двигаться вправо с единичной
скоростью и за время 2 полностью покинет расчётную область.


### Тестовый пример 2

После того, как этот тест будет пройден,
использовать постановку с непостоянной по пространству скоростью
\f{equation*}{
    U(x, y) = -y, \quad V(x, y) = x.
\f}

и начальным решением вида
\f{align*}{
    &r_0(x, y) = \sqrt{(x - 0.5)^2 + y^2}; \; \sigma = 0.1;\\
    &u(x, y, 0) = u_0(x, y) = e^{-r_0^2(x, y)/\sigma^2}
\f}

\image html transport1_work_02.png width=1000

В процессе решения этот "холмик" будет
двигаться по окружности, описывая полный оборот за время \f(t=4\pi\f).

Точное решение на момент времени \f(t\f) будет иметь вид
\f{align*}{
  	& x_c(t) =  0.5\cos(0.5 t); \\
    & y_c(t) =  0.5\sin(0.5 t); \\
    & r(x, y, t) = \sqrt{(x - x_c(t))^2 + (y - y_c(t))^2};  \\
    & u^e(x, y, t) = e^{-r^2(x, y, t)/\sigma^2}
\f}


## Расчётная схема

Использовать противопотоковую явную схему:
\f{equation*}{
    \frac{\hat u_k - u_k}{\tau}
        + U_k \frac{u_k - u_{\upx{k}}}{h_x}
        + V_k \frac{u_k - u_{\upy{k}}}{h_y} = 0
\f}

Здесь \f(\upx{k}\f), \f(\upy{k}\f) -- 
значения индексов, расположенных против потока
отностительно узла \f(k\f) в направлениях \f(x\f) и \f(y\f) соответственно.

Поскольку скорость в настоящей постановке непостоянная и зависит от точки пространства,
то вычислять индекс узла, расположенного против потока
приходится в зависимости от значения скорости.
С использованием ранее введёных алгоритмов перехода
от парных \f((i, j)\f) индексов к сквозному индексу \f(k\f) \f(\eqref{eq:tasks_ij2k}\f) и обратно \f(\eqref{eq:tasks_k2ij}\f) запишем
\f{align*}{
    & i = i[k]; \\
    & j = j[k]; \\
    & \upx{k} = \begin{cases}
          k[i-1, j], & \quad U_k \geq 0, \\
          k[i+1, j], & \quad U_k < 0 ,\\
      \end{cases} \\
    & \upy{k} = \begin{cases}
          k[i, j-1], & \quad V_k \geq 0, \\
          k[i, j+1], & \quad V_k < 0.\\
      \end{cases}
\f}

На границах использовать условия первого рода. Можно просто нули, поскольку они соответствуют постановке.
